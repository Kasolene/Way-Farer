{"version":3,"sources":["../../server/controllers/userController.js"],"names":["signUpController","req","res","body","email","firstName","lastName","password","isAdmin","users","find","user","status","send","data","message","push","token","userId","length","json","signInController","myuser","index","findIndex"],"mappings":";;;;;;;;AAAA;;AACA;;AACA;;;;AAEO,SAASA,gBAAT,CAA0BC,GAA1B,EAA+BC,GAA/B,EAAoC;AAAA,kBAGrCD,GAAG,CAACE,IAHiC;AAAA,MAEvCC,KAFuC,aAEvCA,KAFuC;AAAA,MAEhCC,SAFgC,aAEhCA,SAFgC;AAAA,MAErBC,QAFqB,aAErBA,QAFqB;AAAA,MAEXC,QAFW,aAEXA,QAFW;AAAA,MAEDC,OAFC,aAEDA,OAFC;;AAKzC,MAAIC,kBAAMC,IAAN,CAAW,UAAAC,IAAI;AAAA,WAAIA,IAAI,CAACP,KAAL,KAAeA,KAAnB;AAAA,GAAf,CAAJ,EAA8C;AAC5CF,IAAAA,GAAG,CAACU,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBD,MAAAA,MAAM,EAAE,GADW;AAEnBE,MAAAA,IAAI,EAAG;AACLC,QAAAA,OAAO,EAAE;AADJ;AAFY,KAArB;AAMD,GAPD,MAOO;AACLN,sBAAMO,IAAN,CAAW;AACTC,MAAAA,KAAK,EAAE,6BAAYb,KAAZ,CADE;AAETc,MAAAA,MAAM,EAAET,kBAAMU,MAFL;AAGTf,MAAAA,KAAK,EAALA,KAHS;AAITC,MAAAA,SAAS,EAATA,SAJS;AAKTC,MAAAA,QAAQ,EAARA,QALS;AAMTC,MAAAA,QAAQ,EAAE,gCAAaA,QAAb,CAND;AAOTC,MAAAA,OAAO,EAAE;AAPA,KAAX;;AASAN,IAAAA,GAAG,CAACU,MAAJ,CAAW,GAAX,EAAgBQ,IAAhB,CAAqB;AACnBR,MAAAA,MAAM,EAAE,GADW;AAEnBE,MAAAA,IAAI,EAACL,kBAAMA,kBAAMU,MAAN,GAAe,CAArB;AAFc,KAArB;AAID;AACF;;AAEM,SAASE,gBAAT,CAA0BpB,GAA1B,EAA+BC,GAA/B,EAAoC;AAAA,mBACbD,GAAG,CAACE,IADS;AAAA,MACjCC,KADiC,cACjCA,KADiC;AAAA,MAC1BG,QAD0B,cAC1BA,QAD0B;;AAEzC,MAAMe,MAAM,GAAGb,kBAAMC,IAAN,CAAW,UAAAC,IAAI;AAAA,WAAIA,IAAI,CAACP,KAAL,KAAeA,KAAf,IAAwB,mCAAgBG,QAAhB,EAA0BI,IAAI,CAACJ,QAA/B,CAA5B;AAAA,GAAf,CAAf;;AAEA,MAAIe,MAAJ,EAAY;AACV,QAAMC,KAAK,GAAGd,kBAAMe,SAAN,CAAgB,UAAAb,IAAI;AAAA,aAAIA,IAAI,CAACP,KAAL,KAAeA,KAAnB;AAAA,KAApB,CAAd;;AACA,QAAMa,KAAK,GAAG,6BAAYb,KAAZ,CAAd;AACAK,sBAAMc,KAAN,EAAaN,KAAb,GAAqBA,KAArB;AACAK,IAAAA,MAAM,CAACL,KAAP,GAAeA,KAAf;AACAf,IAAAA,GAAG,CAACU,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBD,MAAAA,MAAM,EAAE,GADW;AAEnBE,MAAAA,IAAI,EAAE;AACFG,QAAAA,KAAK,EAAEK,MAAM,CAACL,KADZ;AAEFC,QAAAA,MAAM,EAAEI,MAAM,CAACJ,MAFb;AAGFd,QAAAA,KAAK,EAAEkB,MAAM,CAAClB,KAHZ;AAIFC,QAAAA,SAAS,EAAEiB,MAAM,CAACjB,SAJhB;AAKFC,QAAAA,QAAQ,EAAEgB,MAAM,CAAChB;AALf;AAFa,KAArB;AAUD,GAfD,MAeO;AACLJ,IAAAA,GAAG,CAACU,MAAJ,CAAW,GAAX,EAAgBQ,IAAhB,CAAqB;AACnBR,MAAAA,MAAM,EAAG,GADU;AAEnBE,MAAAA,IAAI,EAAG;AACPC,QAAAA,OAAO,EAAE;AADF;AAFY,KAArB;AAMD;AACF","sourcesContent":["import users from '../models/Users';\r\nimport createToken from '../helpers/createToken';\r\nimport { hashPassword, comparePassword } from '../middlewares/hashPassword';\r\n\r\nexport function signUpController(req, res) {\r\n  const {\r\n    email, firstName, lastName, password, isAdmin,\r\n  } = req.body;\r\n\r\n  if (users.find(user => user.email === email)) {\r\n    res.status(409).send({\r\n      status: 409,\r\n      data : {\r\n        message: 'This email is already in use',\r\n      }\r\n    });\r\n  } else {\r\n    users.push({\r\n      token: createToken(email),\r\n      userId: users.length,\r\n      email,\r\n      firstName,\r\n      lastName,\r\n      password: hashPassword(password),\r\n      isAdmin :false,\r\n    });\r\n    res.status(200).json({\r\n      status: 200,\r\n      data:users[users.length - 1]\r\n    });\r\n  }\r\n}\r\n\r\nexport function signInController(req, res) {\r\n  const { email, password } = req.body;\r\n  const myuser = users.find(user => user.email === email && comparePassword(password, user.password));\r\n\r\n  if (myuser) {\r\n    const index = users.findIndex(user => user.email === email);\r\n    const token = createToken(email);\r\n    users[index].token = token;\r\n    myuser.token = token;\r\n    res.status(200).send({\r\n      status: 200,\r\n      data: {\r\n          token: myuser.token,\r\n          userId: myuser.userId,\r\n          email: myuser.email,\r\n          firstName: myuser.firstName,\r\n          lastName: myuser.lastName,\r\n      },\r\n    });\r\n  } else {\r\n    res.status(401).json({\r\n      status : 401,\r\n      data : {\r\n      message: 'Incorrect Email Or Password',\r\n      }\r\n    });\r\n  }\r\n}\r\n"],"file":"userController.js"}