{"version":3,"sources":["../../server/controllers/bookingController.js"],"names":["bookAtrip","req","res","body","tripId","userEmail","trip","trips","find","toString","user","users","email","bookings","push","bookingId","length","userId","busLicenseNumber","tripDate","userFistName","firstName","userLastName","lastName","createdOn","Date","now","status","json","send","data","message","getAllBookings","next","query","isAdmin","myBookings","forEach","element","deleteBooking","params","booking","book","splice","date"],"mappings":"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","sourcesContent":["import bookings from '../models/Bookings';\r\nimport trips from '../models/Trips';\r\nimport users from '../models/Users';\r\n\r\nexport function bookAtrip(req, res) {\r\n    const {\r\n         tripId,userEmail\r\n      } = req.body;\r\n      if(tripId && userEmail){\r\n      const trip = trips.find(trip=>trip.tripId.toString() === tripId);\r\n      const user  = users.find(user=>user.email === userEmail);\r\n      if(trip){\r\n        if(user){\r\n        bookings.push({\r\n          bookingId: bookings.length+1,\r\n          userId : user.userId,\r\n          tripId,\r\n          busLicenseNumber : trip.busLicenseNumber,\r\n          tripDate : trip.tripDate,\r\n          userFistName : user.firstName,\r\n          userLastName : user.lastName,\r\n          userEmail,\r\n          createdOn :Date.now(),\r\n        });\r\n        res.status(201).json(bookings[bookings.length - 1]);\r\n      } else {\r\n        res.status(404).send({\r\n          status: 404,\r\n          data :{\r\n            message : 'specified user not found',\r\n          }\r\n        });\r\n      }\r\n      } else {\r\n        res.status(404).send({\r\n          status: 404,\r\n          data : {\r\n            message : 'specified trip not found',\r\n          }\r\n        });\r\n      }\r\n    } else {\r\n      res.status(400).send({\r\n        status: 400,\r\n        data : {\r\n          message : 'specify the trip id and user email please',\r\n        }\r\n      });\r\n    }\r\n}\r\n\r\nexport function getAllBookings(req, res, next) {\r\n  const {userEmail} = req.query;\r\n  const user  = users.find(user=>user.email === userEmail);\r\n  if(user && user.isAdmin){\r\n    res.status(200).json({\r\n      status: 200,\r\n      data: bookings,\r\n    });\r\n  } else if(user){\r\n    const myBookings = [];\r\n    bookings.forEach(element => {\r\n        if(element.userEmail === userEmail) myBookings.push(element);\r\n    });\r\n    res.status(200).json({\r\n      status: 200,\r\n      data: myBookings,\r\n    });\r\n  } else {\r\n    res.status(404),send({\r\n      status :404,\r\n      data : {\r\n        message: 'user not found',\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nexport function deleteBooking(req, res, next) {\r\n  const { bookingId } = req.params;\r\n  const booking  =  bookings.find(book => book.bookingId.toString() === bookingId);\r\n  if(booking ){\r\n    bookings.splice(booking.bookingId - 1,1);\r\n    res.status(200).send({\r\n      status: 200,\r\n      date : {\r\n        message : 'booking deleted successfully'\r\n      }\r\n    });\r\n  }  else {\r\n   res.status(404).send({\r\n    status: 200,\r\n    date : {\r\n      message : 'booking not found'\r\n    }\r\n   });\r\n  }\r\n }"],"file":"bookingController.js"}