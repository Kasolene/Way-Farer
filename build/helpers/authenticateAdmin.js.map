{"version":3,"sources":["../../server/helpers/authenticateAdmin.js"],"names":["checkAdmin","req","res","next","token","headers","authorization","jwt","verify","err","decoded","users","find","user","isAdmin"],"mappings":";;;;;;;AAAA;;AACA;;AAGA;;;;AAEe,SAASA,UAAT,CAAoBC,GAApB,EAAyBC,GAAzB,EAA8BC,IAA9B,EAAoC;AACjD,MAAIC,KAAK,GAAGH,GAAG,CAACI,OAAJ,CAAY,gBAAZ,KAAiCJ,GAAG,CAACI,OAAJ,CAAYC,aAAzD;AACAF,EAAAA,KAAK,GAAG,qCAAcA,KAAd,CAAR;;AACA,MAAIA,KAAJ,EAAW;AACTG,6BAAIC,MAAJ,CAAWJ,KAAX,EAAkB,SAAlB,EAA6B,UAACK,GAAD,EAAMC,OAAN,EAAkB;AAC7C,UAAID,GAAJ,EAAS;AACP,eAAO,qCAAcP,GAAd,CAAP;AACD;;AACDD,MAAAA,GAAG,CAACS,OAAJ,GAAcA,OAAd;AACA,UAAIC,kBAAMC,IAAN,CAAW,UAAAC,IAAI;AAAA,eAAIA,IAAI,CAACT,KAAL,KAAeA,KAAf,IAAwBS,IAAI,CAACC,OAAjC;AAAA,OAAf,CAAJ,EAA8DX,IAAI,GAAlE,KACK,OAAO,yCAAkBD,GAAlB,CAAP;AACN,KAPD;AAQD,GATD,MASO;AACL,WAAO,kCAAWA,GAAX,CAAP;AACD;AACF","sourcesContent":["import jwt from '../../node_modules/jsonwebtoken';\r\nimport {\r\n  validateToken, TokenUnauthorized, notValidToken, tokenError,\r\n} from '../middlewares/middlewareHelper';\r\nimport users from '../models/Users';\r\n\r\nexport default function checkAdmin(req, res, next) {\r\n  let token = req.headers['x-access-token'] || req.headers.authorization;\r\n  token = validateToken(token);\r\n  if (token) {\r\n    jwt.verify(token, 'nicolas', (err, decoded) => {\r\n      if (err) {\r\n        return notValidToken(res);\r\n      }\r\n      req.decoded = decoded;\r\n      if (users.find(user => user.token === token && user.isAdmin)) next();\r\n      else return TokenUnauthorized(res);\r\n    });\r\n  } else {\r\n    return tokenError(res);\r\n  }\r\n}\r\n"],"file":"authenticateAdmin.js"}